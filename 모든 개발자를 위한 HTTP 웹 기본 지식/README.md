# 모든 개발자를 위한 HTTP 웹 기본 지식

## IP(인터넷 프로토콜)
- 지정한 IP 주소(IP Address)에 데이터 전달
- 패킷이라는 단위로 데이터를 전달


## IP 프로토콜의 한계
- 비연결성
  - 패킷을 받을 상대가 없는 상태여도 전송이 됨
- 비신뢰성
  - 중간에 만약 전달해주는 서버에 문제가 생겼을 경우 소실될 수 있다
  - 대략 1500바이트가 넘으면 패킷을 나눠서 보내게 되는데 이 과정에서 보낸 순서대로 도착하지 않을 수 있다
- 프로그램 구분
  - 같은 IP를 사용하넌 서버에서 통신하는 어플리케이션이 둘 이상이라면?(포트를 지정하지 않음)




## 인터넷 프로토콜 스택의 4계층
![4계층](https://user-images.githubusercontent.com/52727315/166098309-ed196831-a78d-43c0-8d1d-55f27fb11058.png)


## 프로토콜 계층(TCP 버전)
![프로토콜 계층(TCP)](https://user-images.githubusercontent.com/52727315/166098352-57f66fdc-ab75-4f98-8093-445f5497bfdb.png)

## TCP의 특징
- 전송 제어 프로토콜(Transmission Control Protocol)
- 연결지향 - TCP 3 way handshake(가상 연결)
  - 1.SYN(출발지 -> 목적지로 접속 요청)
  - 2.SYN+ACK(목적지 -> 출발지로 요청 수락,접속 요청)
  - 3.ACK(출발지 -> 목적지로 요청 수락 및 데이터 전송)
- 데이터 전달 보증
  - 출발지에서 목적지로 데이터를 전송하였을 때 목적지에서 정상적으로 수신하였다면 수신했다는것을 알려준다
- 순서 보장
  - 출발지에서 패킷1,2,3 순서대로 전달하였는데 목적지엔 패킷1,3,2 순서로 도착하였다면 패킷2부터 다시 보내도록 재요청을한다
- 신뢰할 수 있는 프로토콜
- 현재 대부분 TCP사용

## UDP 특징
- 사용자 데이터그램 프로토콜(User Datagram Protocol)
- 기능이 거의 없다
- TCP 3 way handshake를 지원하지 않는다
- 데이터 전달을 보증하지 않는다
- 순서를 보장하지 않는다
- 단순하며 빠르다
- 단순 IP 프로토콜과 거의 같고 + PORT + 체크썸 정도만 추가되었다
- 다만 최근들어 HTTP3에서는 단순하고 빠른 통신이 가능한 UDP 방식으로 통신을 하도록 지원하고 있다



## PORT
- 같은 IP내에서 프로세스 구분
- 0 ~ 65535까지 할당 가능
  - 0 ~ 1023 -> 잘 알려져있는 포트라 사용하지 않는것이 좋다
  - FTP -> 20, 21
  - TELNET -> 23
  - HTTP -> 80
  - HTTPS -> 443



## DNS
- 도메인 네임 시스템(Domain Name System)
- 전화번호부 같은 역할을 한다
- 도메인명을 IP주소로 변경해준다(DNS서버에 등록되어 있어야 함)



## URI? URL? URN?
- URI (Uniform Resource Identifier)
- URL (Uniform Resource Locator)
  - scheme://[userinfo@]host[:port][/path][?query][#fragment]
  - https://www.google.com:443/search?q=hello&hi=ko
- URN (Uniform Resource Name)
- 간단하게 이야기하자면 URI안에 URL과 URN이 포함되어 있고, 우리가 흔히 웹브라우져에서 사용하는 주소가 URL이다
  - URL: foo://example.com:8080/over/there?name=ferret#nose
  - URN: urn:example:animal:ferret:nose
  - URN 이름만으론 실제 리소스를 찾을 수 있는 방법이 보편화되어 있지 않아 거의 사용하지 않는다



## HTTP (HyperText Transfer Protocol)
- 데이터를 주고 받을 때 사용 (거의 모든 형태의 데이터 전송 가능)
![HTTP구조](https://user-images.githubusercontent.com/52727315/166106722-356218d9-f1a1-4019-b0d2-a8f06edd7b36.png)
- HTTP 메세지 구조
  - 시작라인: HTTP 메서드, 요청 대상, HTTP 버전
  - 헤더: HTTP 전송에 필요한 모든 부가 정보, 메세지 바디 크기, 압축, 인증, 브라우저 정보 등등..
  - 바디: 실제 전송할 데이터. HTML, 이미지, 영상, JSON 등등 byte로 표현 가능한 모든 데이터 전송 가능
- ✨무상태 프로토콜(Stateless)✨
  - 서버가 클라이언트의 상태를 보존하지 않는다 (서버 확장성이 높음_스케일아웃)
  - 클라이언트의 요청을 처리하는 서버가 중간에 변경되더라도 응답이 가능하다
  - 무한한 서버 증설이 가능하다
  - 반대 의미로 상태유지(Stateful)가 있다. 상태유지의 경우 처리하는 서버가 변경되면 안된다.
- 비연결성
  - 클라이언트와 서버간의 연결 유지를 하지 않아 최소한의 자원을 사용한다
  - 초단위 이하의 빠른 속도로 응답한다
  - 서버 자원을 효율적으로 사용할 수 있다
  - 초창기엔 모든 요청마다 연결의 끊고 맺음이 이뤄져서 TCP/IP 연결을 새로 맺는 방식이였으나  
현재는 지속 연결(Persistent Connections)로 문제를 해결하였다
    - 한번의 맺음안에 여러 요청과 응답을 처리하고 맺음을 끊는 방식



## 좋은 URI 설계🧐
- ✨URI설계에서 제일 중요한건 리소스 식별이다
- ✨URI는 리소스와 행위를 분리하여 리소스만 식별한다
  - 리소스 : 회원
  - 행위: 조회, 등록, 삭제, 변경
  - 주로 리소스는 명사, 행위는 동사
- ✨API URI설계는 리소스를 식별하고 계층적 구조로 설계한다
  - ✔계층 구조상 상위를 컬렉션으로 보고 복수단어 사용 권장(member -> members)
  - 회원 목록 조회 /members
  - 회원 조회 /members/{id}
  - 회원 등록 /members/{id}
  - 회원 수정 /members/{id}
  - 회원 삭제 /members/{id}
- 행위는 Http 메서드를 사용하여 구분짓도록 한다


## HTTP 주요 메서드🧐
- GET: 리소스 조회
  - Query(쿼리 파라미터, 쿼리 스트링)을 통하여 서버에 데이터를 전달
  - 메세지 바디를 사용해서 전달은 가능하지만 지원하는 한정적이라 권장하지 않는다
- ✨POST: 요청 데이터 처리
  - 메세지 바디를 통해 서버에 데이터 전달
  - 주로 신규 리소스 등록 또는 프로세스 처리에 사용한다
    - 프로세스 처리에서 사용한다는 의미는 예를들어 결제가 완료되었을 때 사장이 배달시작 버튼을 눌러 프로세스의 상태가 변경되야 하는 경우를 말한다  
    EX) POST /orders/{orderId}/start-delivery  
    (URI설계시 리소스로 식별하는게 베스트지만 그렇지 못할 경우 위와 같이 컨트롤URI 라는 방식으로 설계를 한다)
    - POST의 결과로 새로운 리소스가 생성되지 않을 수 도 있다
  - ✔추가적으로 다른 메서드로 처리하기 애매한 경우에도 사용한다
    - 메세지 바디에 데이터를 담아서 GET메서드를 사용해야하는데 어려울 경우
    - HTTP 메서드 선택이 애매할 경우  
- PUT: 리소스 대체
  - 리소스가 있으면 대체, 없으면 생성(덮어씌우는 개념)
- PATCH: 리소스 부분 변경
- DELETE: 리소스 삭제
- 그 외 기타 메서드
  - HEAD: GET과 동일하지만 상태줄과 헤더만 반환
  - OPTIONS: 대상 리소스에 대한 통신 가능 옵션을 설명(주로 CORS에서 사용)
  - CONNECT: 대상 자원으로 식별되는 서버에 대한 터널을 설정
  - TRACE: 대상 리소스에 대한 경로를 따라 메세지 루프백 테스트 수행




## HTTP 메서드 속성
![HTTP메서드속성](https://user-images.githubusercontent.com/52727315/166140493-5b20715c-919e-4120-8156-4345c8786f0c.png)
- 안전(Safe Methods)
  - 지속적인 호출을 하여도 리소스가 변경되지 않는다
- 멱등(Idempotent Methods)
  - f(f(x)) == f(x)
  - 한번호출하든 여러번 호출하든 결과가 똑같다
    - POST: 결제같은 프로세스를 여러번 호출하면 중복현상이 발생할 수 있다
    - PATCH: 리소스의 일부를 변경하는 부분이 중요한데, count = 1 이라는 데이터를 보냈을 때 count를 1로 변경할 수도 있고 count+=1로 변경할 수 있어서 결과가 다를 수 있다
- 캐시가능(Cacheable Methods)
  - 응답 결과 리소스를 캐시해서 사용해도 되는가
  - POST, PATCH는 본문 내용까지 캐시 키로 고려해야 하는데, 구현이 쉽지 않다








